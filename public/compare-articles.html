<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Comparaison Articles FR/EN - Guide Calypso Bay</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
      }
      .header {
        text-align: center;
        margin-bottom: 30px;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .controls {
        margin-bottom: 20px;
        text-align: center;
      }
      .controls select,
      .controls button {
        margin: 0 10px;
        padding: 10px 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
      }
      .controls button {
        background: #007bff;
        color: white;
        cursor: pointer;
      }
      .controls button:hover {
        background: #0056b3;
      }
      .comparison {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }
      .article-panel {
        background: white;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }
      .article-header {
        background: #007bff;
        color: white;
        padding: 15px;
        font-weight: bold;
        font-size: 18px;
      }
      .article-content {
        padding: 20px;
      }
      .article-content h3 {
        color: #007bff;
        margin-top: 0;
      }
      .article-content img {
        max-width: 100%;
        height: auto;
        margin: 10px 0;
        border-radius: 5px;
      }
      .article-content ul {
        margin: 10px 0;
        padding-left: 20px;
      }
      .article-content li {
        margin: 5px 0;
      }
      .article-content strong {
        color: #333;
      }
      .article-content .wifi-key-container {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin: 15px 0;
        border-left: 4px solid #007bff;
      }
      .article-content .copy-button {
        background: #28a745;
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 3px;
        cursor: pointer;
        margin-left: 10px;
      }
      .article-content .copy-button:hover {
        background: #218838;
      }
      .status {
        text-align: center;
        padding: 20px;
        background: #e9ecef;
        border-radius: 5px;
        margin: 20px 0;
      }
      .status.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .status.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .status.info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      .article-list {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 10px;
        margin: 20px 0;
      }
      .article-item {
        background: white;
        padding: 10px;
        border-radius: 5px;
        border: 1px solid #ddd;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s;
      }
      .article-item:hover {
        background: #f8f9fa;
        border-color: #007bff;
      }
      .article-item.active {
        background: #007bff;
        color: white;
      }
      .debug {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin: 20px 0;
        font-family: monospace;
        font-size: 12px;
        max-height: 200px;
        overflow-y: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üîç Comparaison Articles FR/EN</h1>
        <p>V√©rification c√¥te √† c√¥te des articles du guide Calypso Bay</p>
      </div>

      <div class="controls">
        <select id="article-select">
          <option value="">S√©lectionner un article...</option>
        </select>
        <button onclick="loadArticle()">Charger l'article</button>
        <button onclick="loadAllArticles()">Charger tous les articles</button>
        <button onclick="debugFiles()">Debug fichiers</button>
      </div>

      <div id="status" class="status info">Pr√™t √† comparer les articles</div>

      <div id="debug" class="debug" style="display: none">
        <!-- Debug info -->
      </div>

      <div id="article-list" class="article-list" style="display: none">
        <!-- Liste des articles sera g√©n√©r√©e dynamiquement -->
      </div>

      <div id="comparison" class="comparison" style="display: none">
        <div class="article-panel">
          <div class="article-header">üá´üá∑ Version Fran√ßaise</div>
          <div id="french-content" class="article-content">
            <!-- Contenu fran√ßais -->
          </div>
        </div>
        <div class="article-panel">
          <div class="article-header">üá¨üáß Version Anglaise</div>
          <div id="english-content" class="article-content">
            <!-- Contenu anglais -->
          </div>
        </div>
      </div>
    </div>

    <script>
      let frenchArticles = {}
      let englishArticles = {}
      let currentArticle = ''

      // Debug des fichiers
      async function debugFiles() {
        const debugDiv = document.getElementById('debug')
        debugDiv.style.display = 'block'
        debugDiv.innerHTML = '<h3>Debug des fichiers:</h3>'

        try {
          // Test guide.js
          const responseFR = await fetch('assets/js/guide.js')
          const textFR = await responseFR.text()
          debugDiv.innerHTML += `<p><strong>guide.js:</strong> ${textFR.length} caract√®res</p>`

          const popupDataIndex = textFR.indexOf('this.popupData = {')
          debugDiv.innerHTML += `<p><strong>Index popupData:</strong> ${popupDataIndex}</p>`

          if (popupDataIndex !== -1) {
            const sample = textFR.substring(
              popupDataIndex,
              popupDataIndex + 500
            )
            debugDiv.innerHTML += `<p><strong>√âchantillon:</strong><br><pre>${sample}</pre></p>`
          }

          // Test guide-en.js
          const responseEN = await fetch('assets/js/guide-en.js')
          const textEN = await responseEN.text()
          debugDiv.innerHTML += `<p><strong>guide-en.js:</strong> ${textEN.length} caract√®res</p>`

          const popupDataIndexEN = textEN.indexOf('this.popupData = {')
          debugDiv.innerHTML += `<p><strong>Index popupData EN:</strong> ${popupDataIndexEN}</p>`

          if (popupDataIndexEN !== -1) {
            const sampleEN = textEN.substring(
              popupDataIndexEN,
              popupDataIndexEN + 500
            )
            debugDiv.innerHTML += `<p><strong>√âchantillon EN:</strong><br><pre>${sampleEN}</pre></p>`
          }
        } catch (error) {
          debugDiv.innerHTML += `<p style="color: red;"><strong>Erreur:</strong> ${error.message}</p>`
        }
      }

      // Charger les articles fran√ßais
      async function loadFrenchArticles() {
        try {
          const response = await fetch('assets/js/guide.js')
          const text = await response.text()

          console.log('Fichier guide.js charg√©, taille:', text.length)

          // M√©thode simple : chercher le d√©but et la fin
          const startIndex = text.indexOf('this.popupData = {')
          if (startIndex === -1) {
            updateStatus('popupData non trouv√© dans guide.js', 'error')
            return
          }

          // Chercher la fin de l'objet popupData
          let braceCount = 0
          let endIndex = startIndex + 18 // apr√®s "this.popupData = {"
          let inString = false
          let stringChar = ''

          for (let i = endIndex; i < text.length; i++) {
            const char = text[i]

            if (!inString) {
              if (char === '"' || char === "'" || char === '`') {
                inString = true
                stringChar = char
              } else if (char === '{') {
                braceCount++
              } else if (char === '}') {
                if (braceCount === 0) {
                  endIndex = i
                  break
                }
                braceCount--
              }
            } else {
              if (char === stringChar && text[i - 1] !== '\\') {
                inString = false
              }
            }
          }

          const frenchContent = text.substring(startIndex + 18, endIndex)
          console.log(
            'Contenu popupData extrait, taille:',
            frenchContent.length
          )

          // Parser les articles fran√ßais
          parseArticles(frenchContent, 'french')
          updateStatus('Articles fran√ßais charg√©s', 'success')
        } catch (error) {
          console.error('Erreur chargement fran√ßais:', error)
          updateStatus(
            'Erreur chargement articles fran√ßais: ' + error.message,
            'error'
          )
        }
      }

      // Charger les articles anglais
      async function loadEnglishArticles() {
        try {
          const response = await fetch('assets/js/guide-en.js')
          const text = await response.text()

          console.log('Fichier guide-en.js charg√©, taille:', text.length)

          // M√©thode simple : chercher le d√©but et la fin
          const startIndex = text.indexOf('this.popupData = {')
          if (startIndex === -1) {
            updateStatus('popupData non trouv√© dans guide-en.js', 'error')
            return
          }

          // Chercher la fin de l'objet popupData
          let braceCount = 0
          let endIndex = startIndex + 18 // apr√®s "this.popupData = {"
          let inString = false
          let stringChar = ''

          for (let i = endIndex; i < text.length; i++) {
            const char = text[i]

            if (!inString) {
              if (char === '"' || char === "'" || char === '`') {
                inString = true
                stringChar = char
              } else if (char === '{') {
                braceCount++
              } else if (char === '}') {
                if (braceCount === 0) {
                  endIndex = i
                  break
                }
                braceCount--
              }
            } else {
              if (char === stringChar && text[i - 1] !== '\\') {
                inString = false
              }
            }
          }

          const englishContent = text.substring(startIndex + 18, endIndex)
          console.log(
            'Contenu popupData extrait, taille:',
            englishContent.length
          )

          // Parser les articles anglais
          parseArticles(englishContent, 'english')
          updateStatus('Articles anglais charg√©s', 'success')
        } catch (error) {
          console.error('Erreur chargement anglais:', error)
          updateStatus(
            'Erreur chargement articles anglais: ' + error.message,
            'error'
          )
        }
      }

      // Parser les articles
      function parseArticles(content, language) {
        const articles = {}

        // Regex am√©lior√©e pour capturer les articles (avec cl√©s entre guillemets)
        const articleRegex =
          /(['"`]?)([a-zA-Z0-9_-]+)\1:\s*\{\s*title:\s*['"`]([^'"`]+)['"`],\s*content:\s*`([\s\S]*?)`\s*\}/g
        let match

        while ((match = articleRegex.exec(content)) !== null) {
          const key = match[2] // Le nom de la cl√© (sans guillemets)
          const title = match[3] // Le titre
          const content = match[4] // Le contenu

          articles[key] = {
            title: title,
            content: content
          }
        }

        console.log(
          `Articles ${language} trouv√©s:`,
          Object.keys(articles).length
        )
        console.log(`Cl√©s ${language}:`, Object.keys(articles))

        if (language === 'french') {
          frenchArticles = articles
        } else {
          englishArticles = articles
        }

        updateArticleSelect()
      }

      // Mettre √† jour le s√©lecteur d'articles
      function updateArticleSelect() {
        const select = document.getElementById('article-select')
        select.innerHTML =
          '<option value="">S√©lectionner un article...</option>'

        const allKeys = new Set([
          ...Object.keys(frenchArticles),
          ...Object.keys(englishArticles)
        ])
        allKeys.forEach((key) => {
          const option = document.createElement('option')
          option.value = key
          option.textContent = `${key} - ${
            frenchArticles[key]?.title ||
            englishArticles[key]?.title ||
            'Titre manquant'
          }`
          select.appendChild(option)
        })

        console.log('Selectbox mise √† jour avec', allKeys.size, 'articles')
      }

      // Charger un article sp√©cifique
      function loadArticle() {
        const select = document.getElementById('article-select')
        const articleKey = select.value

        if (!articleKey) {
          updateStatus('Veuillez s√©lectionner un article', 'error')
          return
        }

        currentArticle = articleKey
        displayArticle(articleKey)
      }

      // Afficher un article
      function displayArticle(articleKey) {
        const frenchContent = document.getElementById('french-content')
        const englishContent = document.getElementById('english-content')
        const comparison = document.getElementById('comparison')

        if (frenchArticles[articleKey]) {
          frenchContent.innerHTML = `
                    <h3>${frenchArticles[articleKey].title}</h3>
                    <div>${frenchArticles[articleKey].content}</div>
                `
        } else {
          frenchContent.innerHTML =
            '<p style="color: red;">Article fran√ßais non trouv√©</p>'
        }

        if (englishArticles[articleKey]) {
          englishContent.innerHTML = `
                    <h3>${englishArticles[articleKey].title}</h3>
                    <div>${englishArticles[articleKey].content}</div>
                `
        } else {
          englishContent.innerHTML =
            '<p style="color: red;">Article anglais non trouv√©</p>'
        }

        comparison.style.display = 'grid'
        updateStatus(`Article "${articleKey}" affich√©`, 'success')
      }

      // Charger tous les articles
      function loadAllArticles() {
        const articleList = document.getElementById('article-list')
        articleList.innerHTML = ''
        articleList.style.display = 'grid'

        const allKeys = new Set([
          ...Object.keys(frenchArticles),
          ...Object.keys(englishArticles)
        ])
        allKeys.forEach((key) => {
          const item = document.createElement('div')
          item.className = 'article-item'
          item.textContent = `${key} - ${
            frenchArticles[key]?.title ||
            englishArticles[key]?.title ||
            'Titre manquant'
          }`
          item.onclick = () => {
            document.getElementById('article-select').value = key
            loadArticle()
          }
          articleList.appendChild(item)
        })

        updateStatus(
          `Tous les articles charg√©s (${allKeys.size} articles)`,
          'success'
        )
      }

      // Mettre √† jour le statut
      function updateStatus(message, type = 'info') {
        const status = document.getElementById('status')
        status.textContent = message
        status.className = `status ${type}`
      }

      // Initialisation
      document.addEventListener('DOMContentLoaded', async () => {
        updateStatus('Chargement des articles...', 'info')
        await loadFrenchArticles()
        await loadEnglishArticles()
        updateStatus('Pr√™t √† comparer les articles', 'success')
      })
    </script>
  </body>
</html>
